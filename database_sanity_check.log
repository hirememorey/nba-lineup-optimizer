2025-10-10 16:13:00,395 - INFO - Starting comprehensive database sanity verification...
2025-10-10 16:13:00,395 - INFO - Database: src/nba_stats/db/nba_stats.db
2025-10-10 16:13:00,395 - INFO - Season: 2024-25
2025-10-10 16:13:00,396 - INFO - Successfully connected to database: src/nba_stats/db/nba_stats.db
2025-10-10 16:13:00,396 - INFO - ============================================================
2025-10-10 16:13:00,396 - INFO - LAYER 1: STRUCTURAL & VOLUME VERIFICATION
2025-10-10 16:13:00,396 - INFO - ============================================================
2025-10-10 16:13:00,402 - INFO - [Layer 1] Players count: PASS - Found 5025 records (expected >= 5025)
2025-10-10 16:13:00,402 - INFO - [Layer 1] Teams count: PASS - Found 30 records (expected >= 30)
2025-10-10 16:13:00,404 - INFO - [Layer 1] Games count: PASS - Found 2544 records (expected >= 1230)
2025-10-10 16:13:00,406 - INFO - [Layer 1] PlayerArchetypeFeatures count: PASS - Found 273 players for 2024-25 (expected >= 270)
2025-10-10 16:13:00,406 - INFO - [Layer 1] FTPCT NULL check: PASS - No NULL values found in FTPCT
2025-10-10 16:13:00,406 - INFO - [Layer 1] TSPCT NULL check: PASS - No NULL values found in TSPCT
2025-10-10 16:13:00,406 - INFO - [Layer 1] DRIVES NULL check: PASS - No NULL values found in DRIVES
2025-10-10 16:13:00,406 - INFO - [Layer 1] AVGDIST NULL check: PASS - No NULL values found in AVGDIST
2025-10-10 16:13:00,407 - INFO - [Layer 1] FTr NULL check: PASS - No NULL values found in FTr
2025-10-10 16:13:00,407 - INFO - [Layer 1] TRBPCT NULL check: PASS - No NULL values found in TRBPCT
2025-10-10 16:13:00,407 - INFO - [Layer 1] ASTPCT NULL check: PASS - No NULL values found in ASTPCT
2025-10-10 16:13:00,971 - INFO - [Layer 1] Possessions count: PASS - Found 1186977 possessions (expected >= 574,000)
2025-10-10 16:13:00,972 - INFO - ============================================================
2025-10-10 16:13:00,972 - INFO - LAYER 1.5: SOURCE TABLE SPOT-CHECKS
2025-10-10 16:13:00,972 - INFO - ============================================================
2025-10-10 16:13:00,972 - INFO - [Layer 1.5] PlayerSeasonDriveStats count: PASS - Found 579 records
2025-10-10 16:13:00,974 - INFO - [Layer 1.5] PlayerSeasonDriveStats data quality: PASS - Max drives: 20.6 (expected >= 0.1)
2025-10-10 16:13:00,974 - INFO - [Layer 1.5] PlayerSeasonPostUpStats count: PASS - Found 569 records
2025-10-10 16:13:00,976 - INFO - [Layer 1.5] PlayerSeasonPostUpStats data quality: PASS - Max possessions: 8.8 (expected >= 0.1)
2025-10-10 16:13:00,976 - INFO - [Layer 1.5] PlayerSeasonOpponentShootingStats count: PASS - Found 569 records (expected 569)
2025-10-10 16:13:00,977 - INFO - [Layer 1.5] PlayerSeasonOpponentShootingStats data quality: PASS - Max opp_fga_lt_5ft: 24.0 (expected >= 0.1)
2025-10-10 16:13:00,977 - INFO - ============================================================
2025-10-10 16:13:00,977 - INFO - LAYER 2: DATA RANGE & DISTRIBUTION VALIDATION
2025-10-10 16:13:00,977 - INFO - ============================================================
2025-10-10 16:13:00,982 - INFO - Loaded 273 players from PlayerArchetypeFeatures
2025-10-10 16:13:00,982 - INFO - [Layer 2] FTPCT range check: PASS - Range: 0.456 - 1.000 (expected: 0.456 - 1.0)
2025-10-10 16:13:00,983 - INFO - [Layer 2] FTPCT variance check: PASS - Found 179 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] TSPCT range check: PASS - Range: 0.419 - 0.724 (expected: 0.419 - 0.724)
2025-10-10 16:13:00,983 - INFO - [Layer 2] TSPCT variance check: PASS - Found 137 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] DRIVES range check: PASS - Range: 0.000 - 20.600 (expected: 0.0 - 25.0)
2025-10-10 16:13:00,983 - INFO - [Layer 2] DRIVES variance check: PASS - Found 120 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] AVGDIST range check: PASS - Range: 0.000 - 21.647 (expected: 0.0 - 25.0)
2025-10-10 16:13:00,983 - INFO - [Layer 2] AVGDIST variance check: PASS - Found 52 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] FTr range check: PASS - Range: 0.023 - 0.657 (expected: 0.0 - 0.8)
2025-10-10 16:13:00,983 - INFO - [Layer 2] FTr variance check: PASS - Found 269 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] TRBPCT range check: PASS - Range: 0.029 - 0.203 (expected: 0.0 - 0.3)
2025-10-10 16:13:00,983 - INFO - [Layer 2] TRBPCT variance check: PASS - Found 116 unique values
2025-10-10 16:13:00,983 - INFO - [Layer 2] ASTPCT range check: PASS - Range: 0.044 - 0.452 (expected: 0.0 - 0.5)
2025-10-10 16:13:00,983 - INFO - [Layer 2] ASTPCT variance check: PASS - Found 168 unique values
2025-10-10 16:13:00,983 - INFO - ============================================================
2025-10-10 16:13:00,983 - INFO - LAYER 3: CROSS-TABLE CONSISTENCY CHECK
2025-10-10 16:13:00,983 - INFO - ============================================================
2025-10-10 16:13:00,986 - INFO - [Layer 3] Player ID consistency: PASS - All 270 archetype players found in raw stats
2025-10-10 16:13:00,986 - INFO - [Layer 3] Player overlap check: PASS - Overlap: 270/270 (100.0%)
2025-10-10 16:13:00,986 - INFO - ============================================================
2025-10-10 16:13:00,986 - INFO - VERIFICATION SUMMARY REPORT
2025-10-10 16:13:00,986 - INFO - ============================================================
2025-10-10 16:13:00,986 - INFO - Layer 1: 12/12 PASS, 0/12 FAIL, 0/12 WARN
2025-10-10 16:13:00,986 - INFO - Layer 1.5: 6/6 PASS, 0/6 FAIL, 0/6 WARN
2025-10-10 16:13:00,986 - INFO - Layer 2: 14/14 PASS, 0/14 FAIL, 0/14 WARN
2025-10-10 16:13:00,986 - INFO - Layer 3: 2/2 PASS, 0/2 FAIL, 0/2 WARN
2025-10-10 16:13:00,987 - INFO - ============================================================
2025-10-10 16:13:00,987 - INFO - ðŸŽ‰ ALL CRITICAL VERIFICATIONS PASSED
2025-10-10 16:13:00,987 - INFO - Database is ready for clustering analysis
2025-10-10 16:13:00,987 - INFO - ============================================================
