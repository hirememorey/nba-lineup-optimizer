2025-10-03 11:34:21,732 - INFO - Starting PlayerArchetypeFeatures table reconstruction...
2025-10-03 11:34:21,732 - INFO - FeaturesTableReconstructor initialized
2025-10-03 11:34:21,732 - INFO - Starting reconstruction of PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:21,733 - INFO - Connected to database: src/nba_stats/db/nba_stats.db
2025-10-03 11:34:21,733 - INFO - Creating backup of existing PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:21,741 - INFO - Backup created: PlayerArchetypeFeatures_backup_2024_25 with 311 records
2025-10-03 11:34:21,741 - INFO - Getting clean player data for season 2024-25...
2025-10-03 11:34:21,741 - ERROR - Reconstruction failed with error: Execution failed on sql '
            SELECT * FROM PlayerArchetypeFeatures 
            WHERE season = ?
            ORDER BY player_id, updated_at DESC
        ': no such column: updated_at
2025-10-03 11:34:30,394 - INFO - Starting PlayerArchetypeFeatures table reconstruction...
2025-10-03 11:34:30,394 - INFO - FeaturesTableReconstructor initialized
2025-10-03 11:34:30,394 - INFO - Starting reconstruction of PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:30,394 - INFO - Connected to database: src/nba_stats/db/nba_stats.db
2025-10-03 11:34:30,394 - INFO - Creating backup of existing PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:30,397 - INFO - Backup created: PlayerArchetypeFeatures_backup_2024_25 with 311 records
2025-10-03 11:34:30,397 - INFO - Getting clean player data for season 2024-25...
2025-10-03 11:34:30,403 - INFO - Retrieved 311 records for season 2024-25
2025-10-03 11:34:30,405 - INFO - After removing duplicates: 303 unique players
2025-10-03 11:34:30,405 - INFO - Applying data quality filters...
2025-10-03 11:34:30,406 - INFO - Filtered by shot data: 303 players remaining
2025-10-03 11:34:30,409 - INFO - Quality filtering: 303 -> 303 players (0 removed)
2025-10-03 11:34:30,409 - INFO - After quality filtering: 303 players with clean data
2025-10-03 11:34:30,409 - INFO - Creating clean table structure...
2025-10-03 11:34:30,412 - INFO - Clean table structure created successfully
2025-10-03 11:34:30,412 - INFO - Populating clean table with 303 players...
2025-10-03 11:34:30,413 - ERROR - Failed to populate clean table: CHECK constraint failed: HEIGHT > 0
2025-10-03 11:34:30,413 - ERROR - Failed to populate clean table
2025-10-03 11:34:39,796 - INFO - Starting PlayerArchetypeFeatures table reconstruction...
2025-10-03 11:34:39,796 - INFO - FeaturesTableReconstructor initialized
2025-10-03 11:34:39,796 - INFO - Starting reconstruction of PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:39,796 - INFO - Connected to database: src/nba_stats/db/nba_stats.db
2025-10-03 11:34:39,796 - INFO - Creating backup of existing PlayerArchetypeFeatures table for season 2024-25...
2025-10-03 11:34:39,799 - INFO - Backup created: PlayerArchetypeFeatures_backup_2024_25 with 311 records
2025-10-03 11:34:39,800 - INFO - Getting clean player data for season 2024-25...
2025-10-03 11:34:39,803 - INFO - Retrieved 311 records for season 2024-25
2025-10-03 11:34:39,804 - INFO - After removing duplicates: 303 unique players
2025-10-03 11:34:39,804 - INFO - Applying data quality filters...
2025-10-03 11:34:39,804 - INFO - Filtered by shot data: 303 players remaining
2025-10-03 11:34:39,807 - INFO - Quality filtering: 303 -> 303 players (0 removed)
2025-10-03 11:34:39,807 - INFO - After quality filtering: 303 players with clean data
2025-10-03 11:34:39,807 - INFO - Creating clean table structure...
2025-10-03 11:34:39,811 - INFO - Clean table structure created successfully
2025-10-03 11:34:39,811 - INFO - Populating clean table with 303 players...
2025-10-03 11:34:39,826 - INFO - Successfully populated clean table with 303 players
2025-10-03 11:34:39,826 - INFO - Replacing original table with clean version...
2025-10-03 11:34:39,828 - INFO - Successfully replaced original table with clean version
2025-10-03 11:34:39,829 - INFO - Generating reconstruction report...
2025-10-03 11:34:39,829 - INFO - Reconstruction completed successfully! Report saved to reconstruction_report_2024_25.json
2025-10-03 11:34:39,829 - INFO - Final result: 303 players with clean data
